<form
  id="edit-{{ form_type }}-form"
  data-parsley-validate
  class="form-horizontal form-label-left add-id"
  method="post"
  autocomplete="off"
>
  {{ form.csrf_token() }} {{ form.form_type(value=form_type) }} {{
  form.id(id=form_type + '-id', class="add-id") }}
  <div style="padding:20px">
    <center>
      <button
        id="{{ form_type }}-btn"
        type="button"
        style="width: 15%;"
        class="btn btn-success add-id btn-id"
        value="processData"
      >
        Save
      </button>
    </center>
    <br />
    <div
      id="{{ form_type }}-wizard"
      class="form_wizard wizard_horizontal add-id"
    >
      <ul class="wizard_steps">
        <li>
          <a href="#step-1">
            <span class="step_no">1</span>
            <span class="step_descr"
              >Step 1<br />
              <small>General</small>
            </span>
          </a>
        </li>
        <li>
          <a href="#step-2">
            <span class="step_no">2</span>
            <span class="step_descr"
              >Step 2<br />
              <small>Notification</small>
            </span>
          </a>
        </li>
        <li>
          <a href="#step-3">
            <span class="step_no">3</span>
            <span class="step_descr"
              >Step 3<br />
              <small>Devices</small>
            </span>
          </a>
        </li>
        <li>
          <a href="#step-4">
            <span class="step_no">4</span>
            <span class="step_descr"
              >Step 4<br />
              <small>Workflow</small>
            </span>
          </a>
        </li>
        {% if form_type != "workflow" %}
        <li>
          <a href="#step-5">
            <span class="step_no">5</span>
            <span class="step_descr"
              >Step 5<br />
              <small>Specific</small>
            </span>
          </a>
        </li>
        {% endif %}
      </ul>
      <div id="step-1">
        <div>
          {% if form_type != "workflow" %}
          <label class="hide-run">Type</label>
          <div class="form-group">
            {{ form.type(id=form_type + '-class', class="form-control hide-run
            add-id") }}
          </div>
          {% endif %}
          <label class="hide-run">Name</label>
          <div class="form-group">
            {{ form.name(id=form_type + '-name', class="form-control hide-run
            add-id required") }}
          </div>
          <label class="hide-run">Description</label>
          <div class="form-group">
            {{ form.description(id=form_type + '-description',
            class="form-control hide-run add-id") }}
          </div>
          <label class="hide-run">Vendor</label>
          <div class="form-group">
            {{ form.vendor(id=form_type + '-vendor', class="form-control
            hide-run add-id") }}
          </div>
          <label class="hide-run">Operating System</label>
          <div class="form-group">
            {{ form.operating_system(id=form_type + '-operating_system',
            class="form-control hide-run add-id") }}
          </div>
          <label>Initial Payload</label>
          <div class="form-group">
            {{ form.initial_payload(id=form_type + '-initial_payload',
            class="form-control add-id") }}
          </div>
          <label>Number of retries</label>
          <div class="form-group">
            {{ form.number_of_retries(id=form_type + '-number_of_retries',
            class="form-control add-id") }}
          </div>
          <label>Time between retries (in seconds)</label>
          <div class="form-group">
            {{ form.time_between_retries(id=form_type + '-time_between_retries',
            class="form-control add-id") }}
          </div>
          <fieldset>
            <div class="item">
              <input
                id="{{ form_type }}-push_to_git"
                name="push_to_git"
                class="add-id"
                type="checkbox"
                value="y"
              />
              <label>Push to git</label>
            </div>
          </fieldset>
        </div>
      </div>
      <div id="step-2">
        <fieldset>
          <div class="item">
            <input
              id="{{ form_type }}-send_notification"
              name="send_notification"
              type="checkbox"
              class="add-id"
              value="y"
            />
            <label>Send notification</label>
          </div>
        </fieldset>
        <label>Send Notification Method</label>
        <div class="form-group">
          {{ form.send_notification_method(id=form_type +
          '-send_notification_method', class="form-control add-id") }}
        </div>
        <label>Notification Header</label>
        <div class="form-group">
          {{ form.notification_header(id=form_type + '-notification_header',
          class="form-control add-id") }}
        </div>
        <fieldset>
          <div class="item">
            <input
              id="{{ form_type }}-include_link_in_summary"
              name="include_link_in_summary"
              class="add-id"
              type="checkbox"
              value="y"
            />
            <label>Include Result Link in Summary</label>
          </div>
        </fieldset>
        <label>Mail Recipients (separated by comma)</label>
        <div class="form-group">
          {{ form.mail_recipient(id=form_type + '-mail_recipient',
          class="form-control add-id") }}
        </div>
        <fieldset>
          <div class="item">
            <input
              id="{{ form_type }}-display_only_failed_nodes"
              name="display_only_failed_nodes"
              class="add-id"
              type="checkbox"
              value="y"
            />
            <label>Display only failed nodes</label>
          </div>
        </fieldset>
      </div>
      <div id="step-3" style="min-height: 300px">
        {% if form_type == "workflow" %}
        <fieldset>
          <div class="item">
            <input
              id="workflow-use_workflow_targets"
              name="use_workflow_targets"
              class="add-id"
              type="checkbox"
              value="y"
            />
            <label>Use Workflow Targets</label>
          </div>
        </fieldset>
        {% endif %}
        <label for="devices">Devices</label>
        <div class="form-group">
          {{ form.devices(id=form_type + '-devices', class="form-control
          add-id") }}
        </div>
        <label for="pools">Pools</label>
        <div class="form-group">
          {{ form.pools(id=form_type + '-pools', class="form-control add-id") }}
        </div>
        <label class="hide-run"
          >Python Query (populating will supersede device targets in a parent
          workflow)</label
        >
        <div class="form-group">
          {{ form.python_query(id=form_type + '-python_query',
          class="form-control hide-run add-id") }}
        </div>
        <label class="hide-run">Query Property Type</label>
        <div class="form-group">
          {{ form.query_property_type(id=form_type + '-query_property_type',
          class="form-control hide-run add-id") }}
        </div>
        {% if form_type != "workflow" %}
        <fieldset>
          <div class="item">
            <input
              id="{{ form_type }}-multiprocessing"
              name="multiprocessing"
              class="add-id"
              type="checkbox"
              value="y"
            />
            <label>Multiprocessing</label>
          </div>
        </fieldset>
        <label>Maximum number of processes</label>
        <div class="form-group">
          {{ form.max_processes(id=form_type + '-max_processes',
          class="form-control add-id") }}
        </div>
        <label>Credentials</label>
        <div class="form-group">
          {{ form.credentials(id=form_type + '-credentials', class="form-control
          add-id") }}
        </div>
        <label class="hide-run">Custom Username</label>
        <div class="form-group">
          {{ form.custom_username(id=form_type + '-custom_username',
          class="form-control hide-run add-id") }}
        </div>
        <label class="hide-run">Custom Password</label>
        <div class="form-group">
          {{ form.custom_password(id=form_type + '-custom_password',
          class="form-control hide-run add-id") }}
        </div>
        {% endif %}
      </div>
      <div id="step-4" style="min-height: 300px">
        {% if form_type == "workflow" %}
        <label for="start_jobs">Start Jobs</label>
        <div class="form-group">
          {{ form.start_jobs(id=form_type + '-start_jobs', class="form-control
          add-id") }}
        </div>
        <label for="payload_version" class="no-edit">Payload Version</label>
        <div class="form-group">
          {{ form.payload_version(id=form_type + '-payload_version',
          class="form-control no-edit add-id") }}
        </div>
        <label for="payloads_to_exclude" class="no-edit"
          >Payloads to exclude</label
        >
        <div class="form-group">
          {{ form.payloads_to_exclude(id=form_type + '-payloads_to_exclude',
          class="form-control no-edit add-id") }}
        </div>
        {% endif %}
        <fieldset>
          <div class="item">
            <input
              id="{{ form_type }}-skip"
              name="skip"
              class="hide-run add-id"
              type="checkbox"
              value="y"
            />
            <label class="hide-run">Skip</label>
          </div>
        </fieldset>
        <fieldset>
          <div class="item">
            <input
              id="{{ form_type }}-start_new_connection"
              name="start_new_connection"
              class="hide-run add-id"
              type="checkbox"
              value="y"
            />
            <label class="hide-run">Start New Connection</label>
          </div>
        </fieldset>
        <label class="hide-run">Waiting time (in seconds)</label>
        <div class="form-group">
          {{ form.waiting_time(id=form_type + '-waiting_time',
          class="form-control hide-run add-id") }}
        </div>
        <label class="hide-run">Shape</label>
        <div class="form-group">
          {{ form.shape(id=form_type + '-shape', class="form-control hide-run
          add-id") }}
        </div>
        <label class="hide-run">Color</label>
        <div class="form-group">
          {{ form.color(id=form_type + '-color', class="form-control hide-run
          add-id") }}
        </div>
        <label class="hide-run">Size</label>
        <div class="form-group">
          {{ form.size(id=form_type + '-size', class="form-control hide-run
          add-id") }}
        </div>
      </div>
      {% if form_type != "workflow" %}
      <div id="step-5">
        {% set groups = form.groups or {"Parameters": form.service_fields} %}
        <div
          class="accordion"
          id="accordion"
          role="tablist"
          aria-multiselectable="true"
        >
          {% for group_name, fields in groups.items() %} {% set group_id =
          range(10000) | random %}
          <div class="panel" style="border-color: #000">
            <a
              class="panel-heading collapsed"
              style="background-color:#ddd;"
              role="tab"
              id="heading-{{ group_id }}"
              data-toggle="collapse"
              data-parent="#accordion"
              href="#collapse-{{ group_id }}"
              aria-expanded="false"
              aria-controls="collapse-{{ group_id }}"
            >
              <h4 class="panel-title" style="color:#000;">{{ group_name }}</h4>
            </a>
            <div
              id="collapse-{{ group_id }}"
              class="panel-collapse collapse in"
              role="tabpanel"
              aria-labelledby="heading-{{ group_id }}"
            >
              <div class="panel-body" style="background-color:#fafafa;">
                {% for field_name in fields %} {% if form[field_name].type ==
                "BooleanField" %}
                <fieldset>
                  <div class="item">
                    {% if form[field_name].default %} {{
                    form[field_name](id="{}-{}".format(form_type, field_name),
                    class="add-id", checked=True) }} {% else %} {{
                    form[field_name](id="{}-{}".format(form_type, field_name),
                    class="add-id") }} {% endif %}
                    <label>{{ form[field_name].label }}</label>
                  </div>
                </fieldset>
                {% else %}
                <label>{{ form[field_name].label }}</label>
                <div class="form-group">
                  {{ form[field_name](id="{}-{}".format(form_type, field_name),
                  class="form-control add-id") }}
                </div>
                {% endif %} {% endfor %}
              </div>
            </div>
          </div>
          {% endfor %}
        </div>
      </div>
      {% endif %}
    </div>
  </div>
</form>
